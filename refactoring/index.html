<!DOCTYPE html>
<html lang="ko-KR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Refactoring - 1 | D2VLog</title>
    <meta name="generator" content="VuePress 1.5.3">
    
    <meta name="description" content="Blog">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/assets/css/0.styles.e3b32104.css" as="style"><link rel="preload" href="/assets/js/app.79c66735.js" as="script"><link rel="preload" href="/assets/js/2.dc6c0e31.js" as="script"><link rel="preload" href="/assets/js/14.7355466e.js" as="script"><link rel="prefetch" href="/assets/js/10.0501c0f5.js"><link rel="prefetch" href="/assets/js/11.fc35a1ad.js"><link rel="prefetch" href="/assets/js/12.d07aca5a.js"><link rel="prefetch" href="/assets/js/13.96f725f8.js"><link rel="prefetch" href="/assets/js/15.3f605f70.js"><link rel="prefetch" href="/assets/js/3.9342f8a4.js"><link rel="prefetch" href="/assets/js/4.4ec291d0.js"><link rel="prefetch" href="/assets/js/5.56e3d1ae.js"><link rel="prefetch" href="/assets/js/6.ac27a730.js"><link rel="prefetch" href="/assets/js/7.4b612e2e.js"><link rel="prefetch" href="/assets/js/8.1d85397d.js"><link rel="prefetch" href="/assets/js/9.1106060d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e3b32104.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">D2VLog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Programming" class="dropdown-title"><span class="title">Programming</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/refactoring/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Refactoring
</a></li><li class="dropdown-item"><!----> <a href="/algorithm/" class="nav-link">
  알고리즘
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Security" class="dropdown-title"><span class="title">Security</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/gamehacking/" class="nav-link">
  Game Hacking
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/0n1dev" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Programming" class="dropdown-title"><span class="title">Programming</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/refactoring/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Refactoring
</a></li><li class="dropdown-item"><!----> <a href="/algorithm/" class="nav-link">
  알고리즘
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Security" class="dropdown-title"><span class="title">Security</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/gamehacking/" class="nav-link">
  Game Hacking
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/0n1dev" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/refactoring/" aria-current="page" class="active sidebar-link">Refactoring - 1</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/refactoring/#서두" class="sidebar-link">서두</a></li><li class="sidebar-sub-header"><a href="/refactoring/#예시-코드" class="sidebar-link">예시 코드</a></li><li class="sidebar-sub-header"><a href="/refactoring/#함수-쪼개기" class="sidebar-link">함수 쪼개기</a></li><li class="sidebar-sub-header"><a href="/refactoring/#마무리" class="sidebar-link">마무리</a></li></ul></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Refactoring</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/refactoring/" aria-current="page" class="active sidebar-link">Refactoring - 1</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/refactoring/#서두" class="sidebar-link">서두</a></li><li class="sidebar-sub-header"><a href="/refactoring/#예시-코드" class="sidebar-link">예시 코드</a></li><li class="sidebar-sub-header"><a href="/refactoring/#함수-쪼개기" class="sidebar-link">함수 쪼개기</a></li><li class="sidebar-sub-header"><a href="/refactoring/#마무리" class="sidebar-link">마무리</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="refactoring-1"><a href="#refactoring-1" class="header-anchor">#</a> Refactoring - 1</h1> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>리팩터링 2판 책을 보며 공부 시작.</p></div> <h2 id="서두"><a href="#서두" class="header-anchor">#</a> 서두</h2> <p>취업을 하기 위해 모집 공고를 보면 공통적으로 들어간 단어가 있다.</p> <p><strong>&quot;협업&quot;</strong></p> <p>이처럼 회사에서 개발자들에게 중요하게 요구하는 자세는 협업의 자세다.
자신이 혼자서 일하겠다면 문제가 없겠지만 직장인으로서 회사를 다니며 다른 개발자들과 프로젝트를 진행을한다면
자신이 설계한 프로젝트의 로직을 어느 누가 봤을때 어떠한 로직인지 쉽게 파악이 가능하도록 설계하는것이 중요하다고 생각한다.</p> <h2 id="예시-코드"><a href="#예시-코드" class="header-anchor">#</a> 예시 코드</h2> <h3 id="plays-json"><a href="#plays-json" class="header-anchor">#</a> plays.json</h3> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;hamlet&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Hamlet&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tragedy&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;as-like&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;As You Like It&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;comedy&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;othello&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Othello&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tragedy&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="invoices-json"><a href="#invoices-json" class="header-anchor">#</a> invoices.json</h3> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;customer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BigCo&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;performances&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;playId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;hamlet&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;audience&quot;</span><span class="token operator">:</span> <span class="token number">55</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;playId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;as-like&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;audience&quot;</span><span class="token operator">:</span> <span class="token number">35</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;playId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;othello&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;audience&quot;</span><span class="token operator">:</span> <span class="token number">40</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="statement-function"><a href="#statement-function" class="header-anchor">#</a> statement Function</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">statement</span><span class="token punctuation">(</span><span class="token parameter">invoice<span class="token punctuation">,</span> plays</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> totalAmount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> volumeCredits <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">청구 내역 (고객명: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>invoce<span class="token punctuation">.</span>customer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> format <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>NumberFormat</span><span class="token punctuation">(</span><span class="token string">&quot;en-US&quot;</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> style<span class="token operator">:</span> <span class="token string">&quot;currency&quot;</span><span class="token punctuation">,</span> currency<span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span> minimumFractionDigits<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>format<span class="token punctuation">;</span>
    
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> perf <span class="token keyword">of</span> invoice<span class="token punctuation">.</span>performances<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> play <span class="token operator">=</span> plays<span class="token punctuation">[</span>perf<span class="token punctuation">.</span>playID<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> thisAmount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">switch</span> <span class="token punctuation">(</span>play<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">&quot;tragedy&quot;</span><span class="token operator">:</span> <span class="token comment">// 비극</span>
            thisAmount <span class="token operator">=</span> <span class="token number">40000</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>perf<span class="token punctuation">.</span>audience <span class="token operator">&gt;</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                thisAmount <span class="token operator">+=</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token punctuation">(</span>perf<span class="token punctuation">.</span>audience <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">&quot;comedy&quot;</span><span class="token operator">:</span> <span class="token comment">// 희극</span>
            thisAmount <span class="token operator">=</span> <span class="token number">30000</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>perf<span class="token punctuation">.</span>audience <span class="token operator">&gt;</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                thisAmount <span class="token operator">+=</span> <span class="token number">10000</span> <span class="token operator">+</span> <span class="token number">500</span> <span class="token operator">*</span> <span class="token punctuation">(</span>perf<span class="token punctuation">.</span>audience <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">알 수 없는 장르: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>play<span class="token punctuation">.</span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 포인트 적립</span>
        volumeCredits <span class="token operator">+=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>perf<span class="token punctuation">.</span>audience <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 희극 관객 5명마다 추가 포인트 제공</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;comedy&quot;</span> <span class="token operator">===</span> play<span class="token punctuation">.</span>type<span class="token punctuation">)</span> volumeCredits <span class="token operator">+=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>perf<span class="token punctuation">.</span>audience <span class="token operator">/</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 청구 내역을 출력한다.</span>
        result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>play<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">format</span><span class="token punctuation">(</span>thisAmount<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>perf<span class="token punctuation">.</span>audience<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">석\n)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        totalAmount <span class="token operator">+=</span> thisAmount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">총액: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">format</span><span class="token punctuation">(</span>totalAmount<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">적립 포인트: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>volumeCredits<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">점\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>예시 코드를 보면 짧은 코드라 이해할 구조가 보이지 않는다. 하지만 이러한 코드가 수백 수천 줄짜리 코드라 생각해보면 간단한 인라인 함수여도 이해하기 쉽지 않을것이다.</p> <h2 id="함수-쪼개기"><a href="#함수-쪼개기" class="header-anchor">#</a> 함수 쪼개기</h2> <p>리팩터링을할 때 가장 먼저 전체 동작중 나눌 수 있는 지점을 찾는것이 중요하다.
statement() 함수를 보면 중간 쯤 switch문이 가장 눈에 뛴다.</p> <blockquote><p>별도 함수로 빼냈을 때 유효범위를 벗어나는 변수, 즉 새 함수에서 곧바로 사용할 수 없는 변수를 체크해야 한다.</p></blockquote> <h3 id="switch문-빼내기"><a href="#switch문-빼내기" class="header-anchor">#</a> switch문 빼내기</h3> <h4 id="statement-function-2"><a href="#statement-function-2" class="header-anchor">#</a> statement Function</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">statement</span><span class="token punctuation">(</span><span class="token parameter">invoice<span class="token punctuation">,</span> plays</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> totalAmount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> volumeCredits <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">청구 내역 (고객명: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>invoce<span class="token punctuation">.</span>customer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> format <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>NumberFormat</span><span class="token punctuation">(</span><span class="token string">&quot;en-US&quot;</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> style<span class="token operator">:</span> <span class="token string">&quot;currency&quot;</span><span class="token punctuation">,</span> currency<span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span> minimumFractionDigits<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>format<span class="token punctuation">;</span>
    
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> perf <span class="token keyword">of</span> invoice<span class="token punctuation">.</span>performances<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> play <span class="token operator">=</span> plays<span class="token punctuation">[</span>perf<span class="token punctuation">.</span>playID<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> thisAmount <span class="token operator">=</span> <span class="token function">amountFor</span><span class="token punctuation">(</span>pref<span class="token punctuation">,</span> play<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 포인트 적립</span>
        volumeCredits <span class="token operator">+=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>perf<span class="token punctuation">.</span>audience <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 희극 관객 5명마다 추가 포인트 제공</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;comedy&quot;</span> <span class="token operator">===</span> play<span class="token punctuation">.</span>type<span class="token punctuation">)</span> volumeCredits <span class="token operator">+=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>perf<span class="token punctuation">.</span>audience <span class="token operator">/</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 청구 내역을 출력한다.</span>
        result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>play<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">format</span><span class="token punctuation">(</span>thisAmount<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>perf<span class="token punctuation">.</span>audience<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">석\n)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        totalAmount <span class="token operator">+=</span> thisAmount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">총액: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">format</span><span class="token punctuation">(</span>totalAmount<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">적립 포인트: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>volumeCredits<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">점\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h4 id="amountfor-function"><a href="#amountfor-function" class="header-anchor">#</a> amountFor Function</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">amountFor</span><span class="token punctuation">(</span><span class="token parameter">perf<span class="token punctuation">,</span> play</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> thisAmount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 변수 초기화</span>

    <span class="token keyword">switch</span> <span class="token punctuation">(</span>play<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&quot;tragedy&quot;</span><span class="token operator">:</span> <span class="token comment">// 비극</span>
        thisAmount <span class="token operator">=</span> <span class="token number">40000</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>perf<span class="token punctuation">.</span>audience <span class="token operator">&gt;</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            thisAmount <span class="token operator">+=</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token punctuation">(</span>perf<span class="token punctuation">.</span>audience <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;comedy&quot;</span><span class="token operator">:</span> <span class="token comment">// 희극</span>
        thisAmount <span class="token operator">=</span> <span class="token number">30000</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>perf<span class="token punctuation">.</span>audience <span class="token operator">&gt;</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            thisAmount <span class="token operator">+=</span> <span class="token number">10000</span> <span class="token operator">+</span> <span class="token number">500</span> <span class="token operator">*</span> <span class="token punctuation">(</span>perf<span class="token punctuation">.</span>audience <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">알 수 없는 장르: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>play<span class="token punctuation">.</span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> thisAmount<span class="token punctuation">;</span> <span class="token comment">// 함수 안에서 값이 바뀌는 변수 반환</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><blockquote><p>리팩터링 후에는 항상 테스트하는 습관을 들이는 것이 중요하다. 너무 많이 수정하다 실수를 하면 디버깅하기가 어려워서 결과적으로 작업 시간이 늘어난다.</p></blockquote> <p>다음은 amounFor() 함수의 <strong>변수 이름을 명확</strong>하게 바꿔보자.</p> <h4 id="amountfor-function-2"><a href="#amountfor-function-2" class="header-anchor">#</a> amountFor Function</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">amountFor</span><span class="token punctuation">(</span><span class="token parameter">aPerformance<span class="token punctuation">,</span> play</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// (명확한 이름으로 변경)</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 변수 초기화 (명확한 이름으로 변경)</span>

    <span class="token keyword">switch</span> <span class="token punctuation">(</span>play<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&quot;tragedy&quot;</span><span class="token operator">:</span> <span class="token comment">// 비극</span>
        result <span class="token operator">=</span> <span class="token number">40000</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>aPerformance<span class="token punctuation">.</span>audience <span class="token operator">&gt;</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result <span class="token operator">+=</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token punctuation">(</span>aPerformance<span class="token punctuation">.</span>audience <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;comedy&quot;</span><span class="token operator">:</span> <span class="token comment">// 희극</span>
        result <span class="token operator">=</span> <span class="token number">30000</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>aPerformance<span class="token punctuation">.</span>audience <span class="token operator">&gt;</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result <span class="token operator">+=</span> <span class="token number">10000</span> <span class="token operator">+</span> <span class="token number">500</span> <span class="token operator">*</span> <span class="token punctuation">(</span>aPerformance<span class="token punctuation">.</span>audience <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">알 수 없는 장르: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>play<span class="token punctuation">.</span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> result<span class="token punctuation">;</span> <span class="token comment">// 함수 안에서 값이 바뀌는 변수 반환</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>자바스크립트 같은 동적 타입 언어를 사용할 때 매개변수 이름에 접두어로 타입 이름을 적는게 도움이 된다.
지금처럼 매개변수의 역할이 뚜렷하지 않을 때 부정 관사(a/an)을 붙인다.</p> <blockquote><p>컴퓨터가 이해하는 코드는 바보도 작성할 수 있다. 사람이 이해하도록 작성하는 프로그래머가 진정한 실력자다.</p></blockquote> <h3 id="play-변수-제거하기"><a href="#play-변수-제거하기" class="header-anchor">#</a> play 변수 제거하기</h3> <p>amountFor() 함수의 매개변수를 보면 aPerformance는 루프 변수에서 오기 때문에 값이 변경되지만, play는 aPerformance에서 얻기 때문에 매개변수로 전달할 필요가 없다.</p> <blockquote><p>긴 함수를 쪼갤 때 play 같은 임시 변수들 때문에 로컬 범위에 존재하는 이름이 늘어나면 추출 작업이 복잡해지기 때문에 제거하는것이 좋다.</p></blockquote> <h4 id="playfor-function"><a href="#playfor-function" class="header-anchor">#</a> playFor Function</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">playFor</span><span class="token punctuation">(</span><span class="token parameter">aPerformance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> plays<span class="token punctuation">[</span>aPerformance<span class="token punctuation">.</span>playID<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="statement-function-3"><a href="#statement-function-3" class="header-anchor">#</a> statement Function</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">statement</span><span class="token punctuation">(</span><span class="token parameter">invoice<span class="token punctuation">,</span> plays</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> totalAmount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> volumeCredits <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">청구 내역 (고객명: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>invoce<span class="token punctuation">.</span>customer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> format <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>NumberFormat</span><span class="token punctuation">(</span><span class="token string">&quot;en-US&quot;</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> style<span class="token operator">:</span> <span class="token string">&quot;currency&quot;</span><span class="token punctuation">,</span> currency<span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span> minimumFractionDigits<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>format<span class="token punctuation">;</span>
    
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> perf <span class="token keyword">of</span> invoice<span class="token punctuation">.</span>performances<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> play <span class="token operator">=</span> <span class="token function">playFor</span><span class="token punctuation">(</span>perf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> thisAmount <span class="token operator">=</span> <span class="token function">amountFor</span><span class="token punctuation">(</span>pref<span class="token punctuation">,</span> play<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 포인트 적립</span>
        volumeCredits <span class="token operator">+=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>perf<span class="token punctuation">.</span>audience <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 희극 관객 5명마다 추가 포인트 제공</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;comedy&quot;</span> <span class="token operator">===</span> play<span class="token punctuation">.</span>type<span class="token punctuation">)</span> volumeCredits <span class="token operator">+=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>perf<span class="token punctuation">.</span>audience <span class="token operator">/</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 청구 내역을 출력한다.</span>
        result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>play<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">format</span><span class="token punctuation">(</span>thisAmount<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>perf<span class="token punctuation">.</span>audience<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">석\n)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        totalAmount <span class="token operator">+=</span> thisAmount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">총액: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">format</span><span class="token punctuation">(</span>totalAmount<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">적립 포인트: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>volumeCredits<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">점\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>테스트 후 <strong>변수 인라인하기</strong>를 적용한다.</p> <h4 id="statement-function-4"><a href="#statement-function-4" class="header-anchor">#</a> statement Function</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">statement</span><span class="token punctuation">(</span><span class="token parameter">invoice<span class="token punctuation">,</span> plays</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> totalAmount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> volumeCredits <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">청구 내역 (고객명: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>invoce<span class="token punctuation">.</span>customer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> format <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>NumberFormat</span><span class="token punctuation">(</span><span class="token string">&quot;en-US&quot;</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> style<span class="token operator">:</span> <span class="token string">&quot;currency&quot;</span><span class="token punctuation">,</span> currency<span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span> minimumFractionDigits<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>format<span class="token punctuation">;</span>
    
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> perf <span class="token keyword">of</span> invoice<span class="token punctuation">.</span>performances<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 포인트 적립</span>
        volumeCredits <span class="token operator">+=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>perf<span class="token punctuation">.</span>audience <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 희극 관객 5명마다 추가 포인트 제공</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;comedy&quot;</span> <span class="token operator">===</span> <span class="token function">playFor</span><span class="token punctuation">(</span>perf<span class="token punctuation">)</span><span class="token punctuation">.</span>type<span class="token punctuation">)</span> volumeCredits <span class="token operator">+=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>perf<span class="token punctuation">.</span>audience <span class="token operator">/</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 청구 내역을 출력한다.</span>
        result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">playFor</span><span class="token punctuation">(</span>perf<span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token function">amountFor</span><span class="token punctuation">(</span>pref<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>perf<span class="token punctuation">.</span>audience<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">석\n)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        totalAmount <span class="token operator">+=</span> <span class="token function">amountFor</span><span class="token punctuation">(</span>pref<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">총액: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">format</span><span class="token punctuation">(</span>totalAmount<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">적립 포인트: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>volumeCredits<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">점\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h4 id="amountfor-function-3"><a href="#amountfor-function-3" class="header-anchor">#</a> amountFor Function</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">amountFor</span><span class="token punctuation">(</span><span class="token parameter">aPerformance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// (명확한 이름으로 변경)</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 변수 초기화 (명확한 이름으로 변경)</span>

    <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token function">playFor</span><span class="token punctuation">(</span>aPerformance<span class="token punctuation">)</span><span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&quot;tragedy&quot;</span><span class="token operator">:</span> <span class="token comment">// 비극</span>
        result <span class="token operator">=</span> <span class="token number">40000</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>aPerformance<span class="token punctuation">.</span>audience <span class="token operator">&gt;</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result <span class="token operator">+=</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token punctuation">(</span>aPerformance<span class="token punctuation">.</span>audience <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;comedy&quot;</span><span class="token operator">:</span> <span class="token comment">// 희극</span>
        result <span class="token operator">=</span> <span class="token number">30000</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>aPerformance<span class="token punctuation">.</span>audience <span class="token operator">&gt;</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result <span class="token operator">+=</span> <span class="token number">10000</span> <span class="token operator">+</span> <span class="token number">500</span> <span class="token operator">*</span> <span class="token punctuation">(</span>aPerformance<span class="token punctuation">.</span>audience <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">알 수 없는 장르: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">playFor</span><span class="token punctuation">(</span>aPerformance<span class="token punctuation">)</span><span class="token punctuation">.</span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> result<span class="token punctuation">;</span> <span class="token comment">// 함수 안에서 값이 바뀌는 변수 반환</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="적립-포인트-계산-코드-추출하기"><a href="#적립-포인트-계산-코드-추출하기" class="header-anchor">#</a> 적립 포인트 계산 코드 추출하기</h3> <p>amountFor와 동일하게 pref만 전달하면 된다.</p> <h4 id="volumecreditsfor-function"><a href="#volumecreditsfor-function" class="header-anchor">#</a> volumeCreditsFor Function</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">volumeCreditsFor</span><span class="token punctuation">(</span><span class="token parameter">aPerformance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// (명확한 이름으로 변경)</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    
    <span class="token comment">// 포인트 적립</span>
    result <span class="token operator">+=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>aPerformance<span class="token punctuation">.</span>audience <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 희극 관객 5명마다 추가 포인트 제공</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;comedy&quot;</span> <span class="token operator">===</span> <span class="token function">playFor</span><span class="token punctuation">(</span>aPerformance<span class="token punctuation">)</span><span class="token punctuation">.</span>type<span class="token punctuation">)</span>
        result <span class="token operator">+=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>aPerformance<span class="token punctuation">.</span>audience <span class="token operator">/</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="statement-function-5"><a href="#statement-function-5" class="header-anchor">#</a> statement Function</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">statement</span><span class="token punctuation">(</span><span class="token parameter">invoice<span class="token punctuation">,</span> plays</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> totalAmount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> volumeCredits <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">청구 내역 (고객명: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>invoce<span class="token punctuation">.</span>customer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> format <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>NumberFormat</span><span class="token punctuation">(</span><span class="token string">&quot;en-US&quot;</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> style<span class="token operator">:</span> <span class="token string">&quot;currency&quot;</span><span class="token punctuation">,</span> currency<span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span> minimumFractionDigits<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>format<span class="token punctuation">;</span>
    
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> perf <span class="token keyword">of</span> invoice<span class="token punctuation">.</span>performances<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 포인트 적립</span>
        volumeCredits <span class="token operator">+=</span> <span class="token function">volumeCreditsFor</span><span class="token punctuation">(</span>perf<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 청구 내역을 출력한다.</span>
        result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">playFor</span><span class="token punctuation">(</span>perf<span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token function">amountFor</span><span class="token punctuation">(</span>pref<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>perf<span class="token punctuation">.</span>audience<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">석\n)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        totalAmount <span class="token operator">+=</span> <span class="token function">amountFor</span><span class="token punctuation">(</span>pref<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">총액: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">format</span><span class="token punctuation">(</span>totalAmount<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">적립 포인트: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>volumeCredits<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">점\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="format-변수-제거하기"><a href="#format-변수-제거하기" class="header-anchor">#</a> format 변수 제거하기</h3> <p>format은 임시 변수에 함수를 대입한 형태인데, 이러한 임시 변수를 함수를 직접 선언해 사용하도록 변경하겠다.</p> <h4 id="format-function"><a href="#format-function" class="header-anchor">#</a> format Function</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token parameter">aNumber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>NumberFormat</span><span class="token punctuation">(</span><span class="token string">&quot;en-US&quot;</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> style<span class="token operator">:</span> <span class="token string">&quot;currency&quot;</span><span class="token punctuation">,</span> currency<span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span> 
                        minimumFractionDigits<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>aNumber<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="statement-function-6"><a href="#statement-function-6" class="header-anchor">#</a> statement Function</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">statement</span><span class="token punctuation">(</span><span class="token parameter">invoice<span class="token punctuation">,</span> plays</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> totalAmount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> volumeCredits <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">청구 내역 (고객명: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>invoce<span class="token punctuation">.</span>customer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> perf <span class="token keyword">of</span> invoice<span class="token punctuation">.</span>performances<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 포인트 적립</span>
        volumeCredits <span class="token operator">+=</span> <span class="token function">volumeCreditsFor</span><span class="token punctuation">(</span>perf<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 청구 내역을 출력한다.</span>
        result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">playFor</span><span class="token punctuation">(</span>perf<span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token function">amountFor</span><span class="token punctuation">(</span>pref<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>perf<span class="token punctuation">.</span>audience<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">석\n)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        totalAmount <span class="token operator">+=</span> <span class="token function">amountFor</span><span class="token punctuation">(</span>pref<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">총액: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">format</span><span class="token punctuation">(</span>totalAmount<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">적립 포인트: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>volumeCredits<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">점\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>함수 이름 변경이 필요하다. format은 함수가 하는일에 대해 충분한 설명을 해주지 못한다. 또 템플릿 문자열 안에서 사용될 이름이라 장황하면 맞지 않다.
함수의 역할에 맞는 이름을 골라서 <strong>함수 선언 바꾸기</strong>를 적용하는것이 중요하다.</p> <h4 id="usd-function"><a href="#usd-function" class="header-anchor">#</a> usd Function</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">usd</span><span class="token punctuation">(</span><span class="token parameter">aNumber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>NumberFormat</span><span class="token punctuation">(</span><span class="token string">&quot;en-US&quot;</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> style<span class="token operator">:</span> <span class="token string">&quot;currency&quot;</span><span class="token punctuation">,</span> currency<span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span> 
                        minimumFractionDigits<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>aNumber<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 단위 변환 로직도 함수에 추가.</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="statement-function-7"><a href="#statement-function-7" class="header-anchor">#</a> statement Function</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">statement</span><span class="token punctuation">(</span><span class="token parameter">invoice<span class="token punctuation">,</span> plays</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> totalAmount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> volumeCredits <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">청구 내역 (고객명: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>invoce<span class="token punctuation">.</span>customer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> perf <span class="token keyword">of</span> invoice<span class="token punctuation">.</span>performances<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 포인트 적립</span>
        volumeCredits <span class="token operator">+=</span> <span class="token function">volumeCreditsFor</span><span class="token punctuation">(</span>perf<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 청구 내역을 출력한다.</span>
        result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">playFor</span><span class="token punctuation">(</span>perf<span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">usd</span><span class="token punctuation">(</span><span class="token function">amountFor</span><span class="token punctuation">(</span>pref<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>perf<span class="token punctuation">.</span>audience<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">석\n)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        totalAmount <span class="token operator">+=</span> <span class="token function">amountFor</span><span class="token punctuation">(</span>pref<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">총액: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">usd</span><span class="token punctuation">(</span>totalAmount<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">적립 포인트: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>volumeCredits<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">점\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="volumecredits-변수-제거하기"><a href="#volumecredits-변수-제거하기" class="header-anchor">#</a> volumeCredits 변수 제거하기</h3> <hr> <p>volumeCredits 변수는 반복문을 돌 때마다 값을 누적하기 때문에 리팩터링하기가 까다롭다. 따라서 먼저 <strong>반복문 쪼개기</strong>로 값이 누적되는 부분을 따로 빼냈다.</p> <h4 id="statement-function-8"><a href="#statement-function-8" class="header-anchor">#</a> statement Function</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">statement</span><span class="token punctuation">(</span><span class="token parameter">invoice<span class="token punctuation">,</span> plays</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> totalAmount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">청구 내역 (고객명: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>invoce<span class="token punctuation">.</span>customer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> perf <span class="token keyword">of</span> invoice<span class="token punctuation">.</span>performances<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 청구 내역을 출력한다.</span>
        result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">playFor</span><span class="token punctuation">(</span>perf<span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">usd</span><span class="token punctuation">(</span><span class="token function">amountFor</span><span class="token punctuation">(</span>pref<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>perf<span class="token punctuation">.</span>audience<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">석\n)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        totalAmount <span class="token operator">+=</span> <span class="token function">amountFor</span><span class="token punctuation">(</span>pref<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">let</span> volumeCredits <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 초기화를 반복문 바로 앞으로 이동</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> perf <span class="token keyword">of</span> invoice<span class="token punctuation">.</span>performances<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 포인트 적립</span>
        volumeCredits <span class="token operator">+=</span> <span class="token function">volumeCreditsFor</span><span class="token punctuation">(</span>perf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">총액: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">usd</span><span class="token punctuation">(</span>totalAmount<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">적립 포인트: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>volumeCredits<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">점\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>반복문을 쪼개면 성능 저하 이슈가 생기지 않을까라는 생각할 수 있다.<br>
이 정도는 성능에 미치는 영향이 대체로 미미할 때가 많다. <br></p> <p>하지만 &quot;대체로 그렇다&quot;와 &quot;항상 그렇다&quot;는 엄연히 다르다. 때로는 성능에 상당한 영향을 주기도한다.<br>
그래도 잘 다듬어진 코드가 성능 개선 작업도 수월하고 더 효과적으로 수행할 수 있기 때문에, 결과적으로 더 빠른 코드를 얻을수 있다.<br></p> <p>다음은 volumeCredits 값 갱신과 관련된 코드를 모아서 함수로 추출한다.</p> <h4 id="totalvolumecredits-function"><a href="#totalvolumecredits-function" class="header-anchor">#</a> totalVolumeCredits Function</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">totalVolumeCredits</span><span class="token punctuation">(</span><span class="token parameter">invoice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> perf <span class="token keyword">of</span> invoice<span class="token punctuation">.</span>performances<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 포인트 적립</span>
        result <span class="token operator">+=</span> <span class="token function">volumeCreditsFor</span><span class="token punctuation">(</span>perf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="statement-function-9"><a href="#statement-function-9" class="header-anchor">#</a> statement Function</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">statement</span><span class="token punctuation">(</span><span class="token parameter">invoice<span class="token punctuation">,</span> plays</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> totalAmount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">청구 내역 (고객명: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>invoce<span class="token punctuation">.</span>customer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> perf <span class="token keyword">of</span> invoice<span class="token punctuation">.</span>performances<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 청구 내역을 출력한다.</span>
        result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">playFor</span><span class="token punctuation">(</span>perf<span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">usd</span><span class="token punctuation">(</span><span class="token function">amountFor</span><span class="token punctuation">(</span>pref<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>perf<span class="token punctuation">.</span>audience<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">석\n)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        totalAmount <span class="token operator">+=</span> <span class="token function">amountFor</span><span class="token punctuation">(</span>pref<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">총액: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">usd</span><span class="token punctuation">(</span>totalAmount<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    result <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">적립 포인트: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">totalVolumeCredits</span><span class="token punctuation">(</span>invoice<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">점\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span> <span class="token comment">// 인라인</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="마무리"><a href="#마무리" class="header-anchor">#</a> 마무리</h2> <p>해당 코드는 한빛미디어에서 출판한 리팩터링 2판을 보고 작성된 코드이다. <br>
아마 동작은 안될것이다. 그 이유는 playFor() 함수를 보면 plays를 받아와야 하는데 받아오는 부분이 없다 그리고 해당 부분을 받아오게 된다면 모든 함수가 plays.json의 데이터가 필요할텐데... <br>
책에는 이에대한 언급은 없다. <br>
동작을 떠나서 <font color="red"><strong>마틴 파울러가 전달하고 싶은 내용</strong></font>이 무엇인지 요점을 파악하고 읽는것에 중점을 두고 정독을 목표로 가져야겠다. <br></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/refactoring/" aria-current="page" class="router-link-exact-active router-link-active">
        Refactoring - 1
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.79c66735.js" defer></script><script src="/assets/js/2.dc6c0e31.js" defer></script><script src="/assets/js/14.7355466e.js" defer></script>
  </body>
</html>
